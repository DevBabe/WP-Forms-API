{"name":"WP Forms API","tagline":"A Drupal-esque API for creating and munging forms in WordPress","body":"# WP Forms API\r\n\r\n<p align=\"center\">\r\n  <img width=\"490\" height=\"275\" src=\"https://github.com/bendoh/WP-Forms-API/raw/master/finally.jpg\">\r\n</p>\r\n\r\n*A Drupal-esque API for creating and processing forms in WordPress.*\r\n\r\nProvides a `WP_Forms_API` class composed of static methods which can be used to render forms defined by arbitrary data structures. You can also process the results submitted in those forms into a coherent set of values, smoothing over data types, validation (TODO: not yet!!), conditional logic and allowing for functional integration into WordPress using filters.\r\n\r\n## Why?\r\n\r\nWriting and managing admin forms in WordPress is a real pain in the butt, and a data-driven approach is much more flexible and Drupal-y. WordPress tends to implement forms and other complex markup structures with literal markup templates, but those can be very difficult to manage and update. I have not seen any other similar development projects that brings some of the best ideas from Drupal into WordPress where they can benefit developers and clients alike by providing rapid development tools.\r\n\r\nHaving forms driven by data sets instead of templates and markup creates a very generic, predictable, and stylizable structure in the rendered form markup, and easy management and updates to the form structure.\r\n\r\nAlso provides more WordPress-specific form controls, such as \"Select Image\" or \"Select Post\" fields, which can enable powerful admin forms with very little code.\r\n\r\n## Overview\r\n\r\nThere are two basic elements:\r\n\r\n'form', which is any associative array.\r\n\r\n'element', a form that has at least `#type` and `#key` keys.\r\n\r\n## Build\r\n\r\nThis project uses NPM to manage dependencies and gulp to build. Use `npm install` to install all the dependencies. Use `gulp` to build the CSS files.\r\n\r\n## API Quick Start\r\n\r\n```php\r\n/**\r\n * Define a form called 'my-form' which contains an address1 and address2\r\n * input, and another form called 'citystatezip' which contains three input\r\n * elements: city, state, zipcode\r\n */\r\n$form = array(\r\n  '#id' => 'my-form',\r\n\r\n  'address1' => array(\r\n    '#label' => \"Street\",\r\n    '#type' => 'text',\r\n    '#placeholder' => \"Line 1\",\r\n  ),\r\n  'address2' => array(\r\n    '#type' => 'text',\r\n    '#placeholder' => \"Line 2\"\r\n  ),\r\n\r\n  'citystatezip' => array(\r\n    'city' => array(\r\n      '#type' => 'text',\r\n      '#label' => \"City\",\r\n      '#placeholder' => \"Boston\",\r\n      '#size' => 20\r\n    ),\r\n    'state' => array(\r\n      '#type' => 'text',\r\n      '#label' => \"State\",\r\n      '#placeholder' => \"MA\",\r\n      '#size' => 4,\r\n    ),\r\n    'zipcode' => array(\r\n      '#type' => 'text',\r\n      '#label' => \"ZIP\",\r\n      '#placeholder' => \"01011\",\r\n      '#size' => 7\r\n    )\r\n  ),\r\n);\r\n\r\n/**\r\n * Define the values for this form\r\n */\r\n$values = array(\r\n  'city' => \"Omaha\",\r\n  'state' => \"Nebraska\"\r\n);\r\n\r\n/**\r\n * You can render the form in whatever context you'd like: Front-end, meta boxes,\r\n * wherever. Does not render containing <form> elements: the form is expected to be\r\n * defined at this point.\r\n */\r\necho WP_Forms_API::render_form( $form, $values );\r\n\r\n/**\r\n * Now I want to save the elements from this form. Each element gets an input\r\n * with the same name as its '#key' which defaults to its array key.\r\n */\r\nadd_action( 'save_post', function( $post ) use ( $form ) {\r\n  $post = get_post( $post );\r\n\r\n  // Fill in posted values for this form in $values. Every key\r\n  // in $values is guaranteed to be defined for every input in defined in $form.\r\n  WP_Forms_API::process_form( $form, $values );\r\n\r\n  update_post_meta( $post->ID, 'city', $values['city'] );\r\n} )\r\n```\r\n\r\n## Reference\r\n\r\nForms and elements are represented with simple associative arrays.\r\n\r\nA form is a top-level object, but an element is also a form.\r\n\r\nSpecial keys start with '#', all other keys are interpreted as elements in themselves.\r\n\r\nAny form that contains a `#type` key is considered to be an input element and will\r\ncreate a corresponding named form input.\r\n\r\n### Functions\r\n\r\nThis plugin implements a class `WP_Forms_API` which provides the following static methods:\r\n\r\n\r\n* `WP_Forms_API::render_form( $form, &$values )`\r\n\r\nRecursively render a form using values in `$values` and return its markup. This is the primary rendering function you'll need. Applies `wp_form` filter to the form before rendering.\r\n\r\n`$form` - (array) - The form to render.\r\n\r\n`$values` - (array ref) - The values for the elements in this form. While the form structure is nested and heirarchical, the values structure is flat (mostly: see 'composite' values).\r\n\r\n`$top` - (optional array) - The top-level form.\r\n\r\n\r\n* `WP_Forms_API::render_element( $element, &$values )` - Render a single element.\r\n\r\nRenders an element, and any sub-forms, returning the rendered markup. You must specify a scalar `#key` in an element or else an exception will be thrown.\r\n\r\n`$form` - (array) - The form to render.\r\n\r\n`$values` - (array ref) - The values for the elements in this form. While the form structure is nested and heirarchical, the values structure is flat (mostly: see 'composite' values).\r\n\r\nApplies `wp_form_element` filter to element before rendering.\r\n\r\n\r\n* `WP_Forms_API::make_tag( $tagname, $attrs, $content = null )`\r\n\r\nMake and return a single HTML tag.\r\n\r\n`$tagname` - (string) - The name of the HTML tag to emit. If empty, do nothing.\r\n\r\n`$attrs` - (array) - An associative array of HTML attributes for this tag.\r\n\r\n`$content` - (string|false) - The content for this tag, if any. If null, then emit a self-closing tag. If `false`, then the tag will not be closed.\r\n\r\n\r\n* `WP_Forms_API::get_elements( $form )` - Initialize and return all of the elements of a form.\r\n\r\n`$form` - (array) The form to extract elements from.\r\n\r\nUse this function to get initialized sub-elements from a form, skipping all the special keys.\r\n\r\n\r\n* `WP_Forms_API::process_form( $form, &$values, $input = null )` - Process a submitted form and extract submitted values.\r\n\r\n`$form` - (array) - The form to process.\r\n\r\n`$values` - (array reference) - Save result values into this structure.\r\n\r\n`$input` - (array, optional) - The input array. Defaults to `$_POST`.\r\n\r\n\r\n### Filters\r\n\r\nForms and form elements are run through the `wp_form` and `wp_form_element` WP filters, respectively, before they are rendered. This gives developers the ability to define special input tags, (by setting in the `#tag` property), as well as updating or hiding elements as they are rendered.\r\n\r\nThe `wp_form` filter receives `$form, $top` as arguments, where `$form` is the current form node, and `$top` is the top-level form. You can identify specific forms using the `#id` key, but any arbitrary key starting with `#` can be also be used.\r\n\r\nThe `wp_form_element` filter recieves `$element, $form` as\r\n\r\n\r\n### Forms\r\n\r\nAll keys in forms are optional.\r\n\r\n* `#id` (string)\r\n\r\nThe reference ID for this form, for filtering output. When defined, elements are run through the filter `wp_form_element_{$form_id}-{$element_key}` before they are rendered, so they can be modified, removed, or otherwise.\r\n\r\n* `#label` (string)\r\n\r\nThe label for this form or element.\r\n\r\n* `#class` (array)\r\n\r\nCSS classes in `class` attributes.\r\n\r\n* `#attrs` (array)\r\n\r\nThe attributes to use for the rendered container tag. If `class` key is specified, is it prepended by the classes in `#class`.\r\n\r\n* `#form` (array)\r\n\r\nThe top-level form. This defaults to the form itself.\r\n\r\n* `#container` (string)\r\n\r\nThe tag name for the container of this form or element. Defaults to `div`.\r\n\r\n* `#container_classes` (array)\r\n\r\nAn array of CSS classes to add to the container element.\r\n\r\n\r\n### Elements\r\n\r\nAn element is an associative array with at least a `#type` key. An element\r\ncan have any of the properties of a form, as well as the following:\r\n\r\n* `#type` (string)\r\n\r\nWhen present, indicates that the element is an input element. Values:\r\n\r\n* `'text'` â€“ Plain text input.\r\n* `'select'` - A select box. Requires `#options` key.\r\n* `'checkbox'` - A boolean.\r\n* `'textarea'` - A textarea.\r\n* `'multiple'` - A collection of values.\r\n* `'composite'` - A composite value which is posted as an array in #key.\r\n* `'image'` - An image from the media library\r\n* `'post_select'` - A post\r\n\r\n* Any other value will be rendered as a text input. You can use custom types along with the `wp_form_element` filter to define input tag types\r\n\r\n*  `#key` (string)\r\n\r\nThe key for this element. Is used to create default form element `name`\r\nattributes and slugs for classes.\r\n\r\n*  `#placeholder` (string)\r\n\r\nThe placeholder to use in the form element. Applies to 'text' and 'textarea' types.\r\n\r\n*  `#options` (array)\r\n\r\nThe options, as given by 'value' => \"Label\", for this input element. Only applies to select.\r\n\r\n*  `#required` (bool)\r\n\r\nWhether or not the key is required. (TODO: Currently only affects `'select'`-type elements.)\r\n\r\n*  `#name` (string, optional)\r\n\r\nThe input element name - defaults to `#key`.\r\n\r\n*  `#slug` (string, optional)\r\n\r\nThe CSS element name - defaults to `#key`.\r\n\r\n*  `#size` (int)\r\n\r\nThe size of the element.\r\n\r\n*  `#multiple` (array)\r\n\r\nRequired for `$form['#type'] == 'multiple'`. Define another form whose values are collected into an array for this element.\r\n\r\n*  `#add_link` (string)\r\n\r\nWhen using #multiple, the text to show for the \"Add Item\" button.\r\n\r\n*  `#remove_link` (string)\r\n\r\nWhen using #multiple, the text to show for the \"Remove Item\" button.\r\n\r\n*  `#post_type` (string)\r\n\r\nFor `#type = 'post_select'`, the space-separated list of valid post types to search against.\r\n\r\n* `#conditional` (array)\r\n\r\nShow or hide elements depending on the element's value. Please note that conditional logic only works on input types that trigger a Javascript change event (e.g. select menus, checkboxes, radios, etc)\r\n\r\n* `element` â€“ A jQuery-esk selector for the element that should react to changes to this element's value (e.g. `#element-id`, `.element-class`, etc).\r\n* `action` - The action perform on the element. Either 'show' or 'hide'.\r\n* `value` - If the value of the input is this value, then show|hide the target element.\r\n\r\n### Filterable element properties\r\n\r\nThese properties should only be modified in the `wp_form_element` filter.\r\n\r\n*  `#content` (string)\r\n\r\nAny content to put in the input tag. Additional content from rendering the tag will be appended to this value if it is provided. Only applies to `'select'` and `'checkbox'` types, but will render <input> tags with this content if it is provided.\r\n\r\n*  `#tag` (string)\r\n\r\nThe actual tag name to use for the input.\r\n\r\n### Rendered Input Names\r\n\r\nForm input elements rendered using this API are receive the name specified in `#name`, which defaults to as their `#key`.\r\n\r\nFor `'#type' => 'composite'`, any elements in the form tree below the current element receive names that result in an associative array being submitted for that `#key`. For example, the form defined below:\r\n\r\n```php\r\n$form = array(\r\n  'address' => array(\r\n    '#type' => 'composite',\r\n    'city' => array( '#type' => 'text', '#label' => \"City\" ),\r\n    'state' => array( '#type' => 'text', '#label' => \"State\" ),\r\n    'zip' => array( '#type' => 'text', '#label' => \"ZIP\" ),\r\n  )\r\n);\r\n```\r\n\r\nWill result in three input elements named `address[city]`, `address[state]`, and `address[zip]`.\r\n\r\nFor `'#type' => 'multiple'`, you must specify a `#multiple` key, which is a form whose values are collected into an indexed array. For example, the following form:\r\n\r\n```php\r\n$form = array(\r\n  'favorites' => array(\r\n    '#type' => 'multiple',\r\n    '#multiple' => array(\r\n      'name' => array( '#type' => 'text', '#label' => \"Favorite:\" )\r\n    )\r\n  )\r\n);\r\n```\r\n\r\nWill result in a multi-valued form with inputs named `favorites[0][name]`, `favorites[1][name]`, and so on, for each value submitted. The form will always render at least one empty input. When multiple-valued form elements are used, the script handle `wp-forms` is enqueued, which manages control of adding / removing multiple elements.\r\n\r\nIn general, the naming should be unimportant to you when using `process_form()`, but it is important to know how `$values` will be structured `$values` after calling `process_form()`.\r\n\r\n\r\n### Processing\r\n\r\nUse the method `WP_Forms_API::process_form( $form, $values )` to populate $values with named elements defined by $form. By default will use values from `$_POST`, but you can pass an optional third argument to pull element values from.\r\n\r\nThe filter `wp_form_process` is called with arguments `$form, &$values, &$input` and allows modification of forms or sub-forms before they are rendered. You can access the top-level form in `$form['#form']`\r\n\r\nThe filter `wp_form_process_element` is called with `$element, &$values, &$input`, and allows modification of individual elements before they are processed. You can access the sub-form that this element is a part of in `$element['#form']`, and the top-level form in `$element['#form']['#form']`.\r\n\r\nIn each of these filters, `&$values` and `&$input` may refer to sub-arrays of the original `$values` and `$input` arrays. To access the top-level of these structures, access `$form['#form']['#values']` and `$form['#form']['#input']` for forms, and `$element['#form']['#form']['#values']` and `$element['#form']['#form']['#input']` for elements.\r\n\r\n\r\n## CSS\r\n\r\nElement slugs are built from the chain of parent elements, separated by `'-'`. These slugs are used to form CSS class names for elements for targeted styling.\r\n\r\nForms get the following classes: `.wp-form`, and if #id is defined, `.wp-form-{$form['#id']}`. They also receive the attribute `id=\"{$element['#id']}\"`\r\n\r\nEach element is rendered in a container element of tag `#container` with classes defined in `#container_classes`. The following classes are also added to the container element: `.wp-form-element .wp-form-element-{$slug}`.\r\n\r\nEach input element is rendered using the tag `$element['#tag']` and attributes in `$element['#attrs']`. These values can be modified per-element using the `wp_form_element` filter. The default classes are `.wp-form-input` and `.wp-form-input-{$element['#slug']}`.\r\n\r\nLabels receive the classes `.wp-form-label` and `.wp-form-label-{$element['#slug']}`.\r\n\r\n\r\n## Examples\r\n\r\nAn example form might look like the following, which captures a name and a zip code:\r\n\r\n```php\r\n<form method=\"post\" action=\"/my/form/handler\">\r\n<?php\r\n\t$form = array(\r\n\t\t'name' => array(\r\n\t\t\t'#type' => 'text',\r\n\t\t\t'#label' => \"Enter your name:\",\r\n\t\t\t'#placeholder' => \"Charlie Brown\"\r\n\t\t),\r\n\t\t'zipcode' => array(\r\n\t\t\t'#type' => 'text',\r\n\t\t\t'#label' => \"Enter your ZIP code:\",\r\n\t\t\t'#placeholder' => \"90210\",\r\n\t\t\t'#size' => 5\r\n\t\t),\r\n\t\t'save' => array(\r\n\t\t\t'#type' => 'submit',\r\n\t\t\t'#value' => \"Save Information\"\r\n\t\t)\r\n\t);\r\n\r\n\techo WP_Forms_API::render_form( $form, $input );\r\n?>\r\n</form>\r\n```\r\n\r\nThis form will present two input fields: `'name'`, and `'zipcode'`, as well as a submit button that is labelled \"Save Information\".\r\n\r\nYou can process the form using `WP_Forms_API::process_form()`:\r\n\r\n```php\r\n<!-- Then process the form -->\r\n<?php\r\n\tWP_Forms_API::process_form( $form, $values );\r\n?>\r\n\r\n<p>\r\n\tYour name is: <?php echo esc_html( $form['name'] ); ?>\r\n</p>\r\n\r\n<p>\r\n\tYour ZIP is: <?php echo esc_html( $form['zipcode'] ); ?>\r\n</p>\r\n```\r\n\r\n## Please help!\r\n\r\nThis project is merely a generalization of work I did for another project. I've spent many frustrating hours building forms in WordPress, and I knew there had to be an easier way. This doesn't claim to be nearly as powerful as the Drupal Forms API, but maybe one day, with your help, it could be!\r\n\r\n## Plugin brought to you by Oomph, Inc\r\n\r\n![](https://github.com/gdtrombetti/WP-Forms-API/blob/master/images/Oomph_logo.png)\r\n\r\nOomph is a full service digital design and engineering firm assisting premium brands and media companies with large-scale content engagement solutions.\r\nhttp://oomphinc.com/\r\n","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}